(()=>{var o,t;$("#loading").load("/components/loading.html"),$("#footer").load("/Menu/Footer.html"),$("#back-to-top").load("/Menu/backToTop.html");var n,e,s,i,r,a=-1,c=!0;function l(){let o=$("#search-input").val();""==o||c?""===o&&(s.toggleClass("active"),r.focus(),a=-1):window.location.href=e[a].href}function d(){return new Promise(((o,t)=>{i.on("click",(function(){l()})),r.on("keydown",(function(o){13===o.keyCode&&l()})),o()})).catch((()=>{console.log("按鈕切換失敗"),reject()}))}function u(){if(window.innerWidth<=767){var o=$(".right-foot .info"),t=$(".right-foot ul");o.each((function(o){$(this).attr("index",o),$(this).on("click",(function(){current=$(".right-foot .current"),current&&current.removeClass("current");var o=$(this).attr("index");current&&current.is(t[o])?current.removeClass("current"):t.eq(o).addClass("current")}))}))}}$("#header").load("/Menu/Header.html",(function(){$("#sign-in-up").load("/components/SignUp.html",(function(){$(".homemaking_member_item .login_button").click((o=>{o.stopPropagation(),$(".sign-in-up").addClass("open").removeClass("s--signup"),$(".sign-in-up_bottom").addClass("open")})),$(".homemaking_member_item .signup_button").click((function(o){o.stopPropagation(),$(".sign-in-up").addClass("open").addClass("s--signup"),$(".sign-in-up_bottom").addClass("open")})),$(".sign-in-up_close").click((function(){$(".sign-in-up").toggleClass("open"),$(".sign-in-up_bottom").removeClass("open"),$(".sign-in-up_forget").removeClass("slide-in-left").addClass("slide-out-left"),$(".sign-in-up_back").css({visibility:"hidden",opacity:"0"})})),$(".sign-in-up_switch-block_img_button").on("click",(function(){$(".sign-in-up").toggleClass("s--signup")})),$(".sign-in-up_forgot-password").on("click",(o=>{o.stopPropagation(),$(".sign-in-up_forget").removeClass("slide-out-left").addClass("slide-in-left"),$(".sign-in-up_back").css({visibility:"visible",opacity:"1"})})),$(".sign-in-up_back").on("click",(()=>{$(".sign-in-up_forget").removeClass("slide-in-left").addClass("slide-out-left"),$(".sign-in-up_back").css({visibility:"hidden",opacity:"0"})}))})),setTimeout((function(){new Promise(((o,t)=>{var n=new Promise(((o,t)=>{$.getJSON("/Product/allProduct.json",(function(t){t.forEach((function(o,t){var n=$("<li>"),e=$("<span>");e.text((t+1).toString().padStart(2,"0")+"."+o.category);var s=$("<span>").append('<i class="fa-solid fa-chevron-right fa-2xs" style="color: #45464c;"></i>');n.append(e),n.append(s),$(".dropdown-menu_category").append(n);var i=$("<li>").addClass("dropdown-menu_product_block"),r=$("<h5>").addClass("dropdown-menu_product_title");r.text((t+1).toString().padStart(2,"0")+"."+o.category);var a=$("<ul>").addClass("dropdown-menu_product_list");o.products.forEach((o=>{var t=$("<li>").addClass("dropdown-menu_product_item"),n=$("<a>").attr("href",`/Product/Products.html?product=${o.id}`).text(o.name);t.append(n),a.append(t)})),i.append(r),i.append(a),$(".dropdown-menu_product").append(i)})),o()})).fail((function(){t()}))}));n.then((()=>{for(var t=0;t<6;t++){var n=$("#d"+(t+1));if(0===n.children().length){var e=$("<p></p>").text("本月份無任何最新消息/異動公告");n.append(e)}}o()})).catch((()=>{t()}))})).then((()=>{new Promise(((o,t)=>{$(".dropdown-menu_category li").hover((function(){var o=$(this).index();$(".dropdown-menu_product_block").eq(o).addClass("active").siblings().removeClass("active")})),$(".dropdown-menu-row").on("click",(function(o){o.stopPropagation()})),$(".dropdown-menu-bottom").on("click",(function(o){o.stopPropagation()})),o()}))})).catch((o=>{console.error("網頁加載失敗:",o)})),function(){var o=$(".progress-wrap path")[0],t=o.getTotalLength();$(o).css("transition","none").css("WebkitTransition","none"),$(o).css("strokeDasharray",t+" "+t),$(o).css("strokeDashoffset",t),o.getBoundingClientRect();var n=function(){var n=$(window).scrollTop(),e=$(document).height()-$(window).height(),s=t-n*t/e;o.style.strokeDashoffset=s};n(),$(window).scroll(n),$(window).on("scroll",(function(){if($(this).scrollTop()>50?$(".progress-wrap").addClass("active-progress"):$(".progress-wrap").removeClass("active-progress"),$(this).scrollTop()>$("#footer").offset().top-$(window).height()){var o=$("#footer").offset().top;$(".progress-wrap").css({top:o-$(this).scrollTop()-85+"px"})}else $(".progress-wrap").css({position:"fixed",bottom:"25px",top:"auto"})})),$(".progress-wrap").on("click",(function(o){return o.preventDefault(),$("html, body").animate({scrollTop:0},50),!1}))}(),new Promise(((o,t)=>{var n=$("#search_list");$.each([{name:"彩色名片",url:"/Product/Products.html"},{name:"Product 2",url:"/Product/Products.html"},{name:"Product 4",url:"/Product/Products.html"},{name:"Product 5",url:"/Product/Products.html"},{name:"Product 6",url:"/Product/Products.html"}],(function(o,t){var e=$("<a>");e.text(t.name).attr("href",t.url).addClass("search_listItem"),n.append(e)})),o()})).catch((()=>reject())).then((()=>new Promise(((o,t)=>{$("html"),n=$("#search_list"),(e=$(".search_listItem")).length,searchBar_noSearchResult=$(".search_no-search-result"),s=$("#search-form"),i=$("#search-button"),r=$("#search-input"),$("#search-button i"),o()})).catch((()=>{console.log("變數載入失敗"),reject()})))).then((()=>{d(),new Promise(((o,t)=>{var s,i;s=$("#search-input"),i=s.val().toLowerCase(),c=!0,(e=$(".search_listItem")).not(":first").each((function(o){$(this).text().toLowerCase().indexOf(i)>-1?(n.css("display","block"),$(this).css("display","flex"),c=!1):$(this).css("display","none")})),c?(n.css("display","block"),searchBar_noSearchResult.css("display","flex")):searchBar_noSearchResult.css("display","none"),""!=i&&i!=undifined||n.css("display","none"),o()})).catch((()=>{console.log("搜尋框失敗")})),$(window).on("resize",(function(){clearTimeout(o),o=setTimeout(d,300)}))})).catch((()=>{console.log("變數資料載入失敗")}))}),100),$(window).on("resize",(function(){clearTimeout(t),t=setTimeout(u,300)}))})),$(document).ready((function(){$("#loading").fadeOut("slow")}))})();