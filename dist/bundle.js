(()=>{"use strict";function e(e,t){t.load(e,(function(e,n,i){"success"===n?(t.addClass("fade-in-fwd"),setTimeout((function(){t.removeClass("fade-in-fwd")}),300)):console.error("載入內容時發生錯誤:",n)}))}function t(e){$(".faq_question_content ul > li").not(":first").each(((t,n)=>{$(n).data("theme")===e?$(n).addClass("current"):$(n).removeClass("current")}))}function n(n){return new Promise(((i,o)=>{const s=n.has("category"),a=n.has("theme"),r=$("#faq_question_block");s||a?(e("/faq/"+n.get("category")+".html",r),setTimeout((function(){const o=$("#faq_question_list");if(a)e("/faq/"+n.get("category")+"/"+n.get("theme")+".html",o),t(n.get("theme")),i();else switch(n.get("category")){case"beginner-guide":e("/faq/beginner-guide/become-a-member.html",o),t("become-a-member"),i();break;case"account-problem":e("/faq/account-problem/common-problem.html",o),t("common-problem"),i();break;case"prepayment-problem":e("/faq/prepayment-problem/prepayment.html",o),t("prepayment"),i();break;case"printing-guide":e("/faq/printing-guide/finalization-guidelines.html",o),t("finalization-guidelines"),i();break;case"file-transmission-problem":e("/faq/file-transmission-problem/file-problem.html",o),t("file-problem"),i();break;case"other-issues":e("/faq/other-issues/technical-support.html",o),t("technical-support"),i();break;default:e("/faq/common-problem.html",o),i()}}),100)):(e("/faq/common-problem.html",r),i())}))}$(window).on("load",(function(){n(new URLSearchParams(window.location.search)).then((()=>{new Promise(((e,t)=>{$(".faq_navigation_item").on("click",(e=>{!function(e,t,n,i){const o={dataName:t.data(n)},s=e+"?"+n+"="+o.dataName;history.pushState(o,"",s)}("/faq.html",$(e.currentTarget),"category"),n(new URLSearchParams(window.location.search))})),e()}))})).catch((e=>{console.error("網頁加載失敗:",e)})),$(window).on("popstate",(function(e){n(new URLSearchParams(window.location.search))}))})),$("#carouselBox").load("/Carousel.html"),$("#priceCount").load("/components/priceCount.html"),$("#orderSOP").load("/components/orderSOP.html",(function(){var e,t,n;e=$("#ordering"),t=$("#highlight"),n=$(".step"),t.css("width","0px"),n.each((function(n){var i=$(this).find(".step_title"),o=$(this).find(".step_pic img");$(this).on("mouseenter",(function(){t.css("width",`calc(100% / 5 * ${n})`),i.css("color","#cc3333"),o.attr("src",`/Image/index/OrderSOP/Step${n+1}-2.png`)})),$(this).on("mouseleave",(function(){i.css("color","#212529"),o.attr("src",`/Image/index/OrderSOP/Step${n+1}.png`)})),$(this).on("click",(function(){window.location.href="/faq.html?category=beginner-guide&theme="+$(this).data("theme")+"#faq"})),e.on("mouseleave",(function(){t.css("width","0px")}))}))})),$(window).on("load",(function(){var e,t;$.getJSON("/News/News.json",(function(e){for(var t=e.slice(-8).reverse(),n=$("#newsItems"),i=0,o=0;o<t.length;o++){var s=t[o],a=$("<div>").addClass("newsbox_content_item").attr("for","newsbox_input"+o),r=$("<div>").addClass("newsbox_content_item_inner"),c=$("<p>").addClass("newsbox_content_item_title"),l=$("<div>").addClass("newsbox_content_item_content"),d=$("<div>").addClass("newsbox_content_item_date");c.text(s.title),l.html(s.content);var h=new Date(s.date),m=h.toLocaleString("en-US",{month:"short"});if(d.html("<span>"+h.getDate()+"</span><br>"+m),r.append(c),r.append(l),a.append(d),a.append(r),n.append(a),(i+=$(".newsbox_content_item").eq(o).outerHeight())>630){a.remove();break}if(630===i)break;n.on("click",(function(){window.location.href="/News.html"}))}})),t=(e=["priceCount_productCategory","priceCount_productName","priceCount_paperTexture1","priceCount_paperTexture2","priceCount_paperTexture3","priceCount_productSize","priceCount_productQuantity"]).length,e.forEach(((e,n)=>{var i=$("#"+e+"-origin"),o=i.children("option").length;i.addClass("s-hidden"),i.wrap('<div class="cusSelBlock '+e+'" id="'+e+'" style="z-index: '+t+'"></div>'),t--,i.after('<div class="selectLabel"></div>');var s=$("#"+e);s.children(".selectLabel").text(i.children("option").eq(0).text());for(var a=$("<ul>",{class:"options"}).insertAfter(s.children(".selectLabel")),r=0;r<o;r++)$("<li>",{text:i.children("option").eq(r).text(),rel:i.children("option").eq(r).val(),style:"z-index: "+(o-r)+";"}).appendTo(a);function c(){for(var e=0;e<o;e++)s.children(".options").children("li").eq(e).css("transform","translateY("+0*e+"px)").css("transition-delay",0*e+"ms");s.children(".options").removeClass("options-active")}s.children(".selectLabel").click((function(){$(this).toggleClass("active"),$(this).hasClass("active")?(function(){s.children(".options").addClass("options-active");for(var e=0;e<o;e++)s.children(".options").children("li").eq(e).attr("tabindex",e).css("transform","translateY("+100*e+"%)").css("transition-delay",30*e+"ms")}(),s.children(".options").on("focus","li",(function(){$this=$(this),$this.addClass("active").siblings().removeClass()})).on("keydown","li",(function(e){return $this=$(this),40==e.keyCode?($this.next().focus(),!1):38==e.keyCode?($this.prev().focus(),!1):void 0})).find("li").first().focus()):c()})),s.children(".options").children("li").on("keypress click",(function(e){e.preventDefault(),s.children(".options").children("li").siblings().removeClass(),c(),s.children(".selectLabel").removeClass("active"),s.children(".selectLabel").text($(this).text()),i.val($(this).text())})),$(document).on("click",(function(e){var t=s;t.is(e.target)||0!==t.has(e.target).length||(s.children(".selectLabel").removeClass("active"),s.children(".options").children("li").siblings().removeClass(),c())}))}))}))})();